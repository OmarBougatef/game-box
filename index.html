<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Love Arcade Pro - Fixed</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        :root { --bg: #0d0d1a; --gold: #ffd700; --accent: #ff4d6d; }
        * { box-sizing: border-box; touch-action: none; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: var(--bg); color: #fff; font-family: 'Press Start 2P', cursive; overflow: hidden; }
        
        .screen { position: absolute; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10; background: var(--bg); }
        .hidden { display: none !important; }

        /* --- HUB --- */
        .hub-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; width: 90%; max-width: 400px; margin-top: 20px; }
        .game-btn { background: #1a1a3a; border: 3px solid #fff; padding: 15px 5px; text-align: center; cursor: pointer; font-size: 8px; transition: 0.2s; }
        .game-btn:active { background: var(--accent); transform: scale(0.95); }
        .game-btn .icon { font-size: 20px; display: block; margin-bottom: 8px; }

        /* --- GAME UI --- */
        #canvas-container { position: relative; border: 4px solid #fff; line-height: 0; }
        canvas { background: #000; display: block; }
        .stats { position: absolute; top: -30px; width: 100%; display: flex; justify-content: space-between; font-size: 10px; }
        .controls-overlay { position: absolute; bottom: 0; width: 100%; height: 60px; display: flex; justify-content: space-between; pointer-events: none; }
        .zone { width: 45%; height: 100%; pointer-events: auto; background: rgba(255,255,255,0.05); border-radius: 10px; }
        
        .back-btn { margin-top: 20px; padding: 10px 20px; background: #444; color: #fff; border: 2px solid #fff; font-family: inherit; font-size: 8px; }
        
        #modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 20px; }
    </style>
</head>
<body>

    <div id="screen-hub" class="screen">
        <div style="font-size: 40px; margin-bottom: 10px;">üëë</div>
        <h1 style="font-size: 14px; color: var(--gold); margin-bottom: 30px;">LOVE ARCADE V2</h1>
        <div class="hub-grid">
            <div class="game-btn" onclick="Launcher.start('MAZE')"><span class="icon">üè∞</span>JOIN ME</div>
            <div class="game-btn" onclick="Launcher.start('CATCH')"><span class="icon">üçé</span>CATCHER</div>
            <div class="game-btn" onclick="Launcher.start('SHIELD')"><span class="icon">üõ°Ô∏è</span>PROTECT</div>
            <div class="game-btn" onclick="Launcher.start('FLY')"><span class="icon">üïäÔ∏è</span>FLIGHT</div>
            <div class="game-btn" onclick="Launcher.start('KISS')"><span class="icon">‚ö°</span>TIMING</div>
            <div class="game-btn" onclick="Launcher.start('UP')"><span class="icon">üöÄ</span>ASCENT</div>
        </div>
    </div>

    <div id="screen-game" class="screen hidden">
        <div id="canvas-container">
            <div class="stats">
                <span>SCORE: <span id="score">0</span></span>
                <span id="game-title"></span>
            </div>
            <canvas id="gameCanvas"></canvas>
            <div class="controls-overlay">
                <div class="zone" onpointerdown="Input.left=true" onpointerup="Input.left=false"></div>
                <div class="zone" onpointerdown="Input.right=true" onpointerup="Input.right=false"></div>
            </div>
        </div>
        <button class="back-btn" onclick="Launcher.stop()">‚¨Ö QUITTER</button>
    </div>

    <div id="modal" class="hidden">
        <h2 id="modal-title" style="color:var(--gold)">BRAVO !</h2>
        <p id="modal-text" style="font-size: 10px; line-height: 1.6;"></p>
        <button class="back-btn" onclick="Launcher.stop()">RETOUR AU MENU</button>
    </div>

    <script>
        const GameConf = { width: 320, height: 400 };
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = GameConf.width;
        canvas.height = GameConf.height;

        const Input = { left: false, right: false };

        // --- DESSIN PRINCESSE ---
        function drawPrincess(x, y, size = 30) {
            const s = size / 16;
            ctx.fillStyle = '#f1c40f'; ctx.fillRect(x+4*s, y+2*s, 8*s, 4*s); // Hair
            ctx.fillStyle = '#f5cba7'; ctx.fillRect(x+5*s, y+5*s, 6*s, 5*s); // Face
            ctx.fillStyle = '#000'; ctx.fillRect(x+6*s, y+7*s, s, s); ctx.fillRect(x+9*s, y+7*s, s, s); // Eyes
            ctx.fillStyle = '#fd79a8'; ctx.fillRect(x+4*s, y+10*s, 8*s, 6*s); // Dress
            ctx.fillStyle = '#ffd700'; ctx.fillRect(x+6*s, y, 4*s, s); // Crown
        }

        // --- MOTEUR DE JEU ---
        const Launcher = {
            active: false,
            mode: '',
            score: 0,
            gameObj: null,
            start(mode) {
                this.mode = mode;
                this.score = 0;
                this.active = true;
                document.getElementById('screen-hub').classList.add('hidden');
                document.getElementById('screen-game').classList.remove('hidden');
                document.getElementById('game-title').innerText = mode;
                this.initGame();
                this.loop();
            },
            initGame() {
                if(this.mode === 'MAZE') this.gameObj = new MazeGame();
                if(this.mode === 'CATCH') this.gameObj = new CatchGame();
                if(this.mode === 'SHIELD') this.gameObj = new ShieldGame();
                if(this.mode === 'FLY') this.gameObj = new FlyGame();
                if(this.mode === 'KISS') this.gameObj = new KissGame();
                if(this.mode === 'UP') this.gameObj = new UpGame();
            },
            loop() {
                if(!this.active) return;
                ctx.clearRect(0,0,320,400);
                this.gameObj.update();
                this.gameObj.draw();
                document.getElementById('score').innerText = this.score;
                requestAnimationFrame(() => this.loop());
            },
            stop() {
                this.active = false;
                document.getElementById('screen-hub').classList.remove('hidden');
                document.getElementById('screen-game').classList.add('hidden');
                document.getElementById('modal').classList.add('hidden');
            },
            win(msg) {
                this.active = false;
                document.getElementById('modal').classList.remove('hidden');
                document.getElementById('modal-title').innerText = "BIEN JOU√â !";
                document.getElementById('modal-text').innerText = msg;
            },
            over(msg) {
                this.active = false;
                document.getElementById('modal').classList.remove('hidden');
                document.getElementById('modal-title').innerText = "OUILLE !";
                document.getElementById('modal-text').innerText = msg;
            }
        };

        // --- 1. MAZE (VRAI LABYRINTHE) ---
        class MazeGame {
            constructor() {
                this.p = { x: 20, y: 20 };
                this.walls = [];
                for(let i=0; i<8; i++) {
                    this.walls.push({x: Math.random()*240+40, y: Math.random()*300+40, w: 60, h: 10});
                    this.walls.push({x: Math.random()*240+40, y: Math.random()*300+40, w: 10, h: 60});
                }
            }
            update() {
                if(Input.left) this.p.x -= 3;
                if(Input.right) this.p.x += 3;
                this.p.y += 1.5; // Glissade vers le bas
                this.walls.forEach(w => {
                    if(this.p.x < w.x+w.w && this.p.x+20 > w.x && this.p.y < w.y+w.h && this.p.y+20 > w.y) Launcher.over("Tu as touch√© un mur !");
                });
                if(this.p.y > 380) Launcher.win("Tu as travers√© les √©preuves !");
                if(this.p.x < 0 || this.p.x > 300) this.p.x = Math.max(0, Math.min(300, this.p.x));
            }
            draw() {
                ctx.fillStyle = "#3498db";
                this.walls.forEach(w => ctx.fillRect(w.x, w.y, w.w, w.h));
                ctx.fillStyle = "#27ae60"; ctx.fillRect(0, 390, 320, 10);
                drawPrincess(this.p.x, this.p.y, 25);
            }
        }

        // --- 2. CATCH ---
        class CatchGame {
            constructor() { this.px = 140; this.items = []; this.f = 0; }
            update() {
                if(Input.left) this.px -= 5; if(Input.right) this.px += 5;
                this.px = Math.max(0, Math.min(280, this.px));
                if(this.f++ % 40 === 0) this.items.push({x: Math.random()*300, y: -20});
                this.items.forEach((it, i) => {
                    it.y += 4;
                    if(it.y > 340 && it.x > this.px - 20 && it.x < this.px + 30) { this.items.splice(i,1); Launcher.score++; }
                    else if(it.y > 400) Launcher.over("Un coeur s'est bris√©...");
                });
                if(Launcher.score >= 20) Launcher.win("Ton amour est sans limite !");
            }
            draw() { this.items.forEach(it => ctx.fillText("‚ù§Ô∏è", it.x, it.y)); drawPrincess(this.px, 350, 40); }
        }

        // --- 3. SHIELD ---
        class ShieldGame {
            constructor() { this.ang = 0; this.enemies = []; this.f = 0; }
            update() {
                this.ang += 0.08;
                if(this.f++ % 50 === 0) {
                    let a = Math.random()*Math.PI*2;
                    this.enemies.push({x: 160+Math.cos(a)*200, y: 200+Math.sin(a)*200, a: a});
                }
                this.enemies.forEach((en, i) => {
                    en.x -= Math.cos(en.a)*2; en.y -= Math.sin(en.a)*2;
                    let dist = Math.hypot(en.x-160, en.y-200);
                    if(dist < 50) {
                        let hitA = Math.atan2(en.y-200, en.x-160);
                        let diff = Math.abs(hitA - (this.ang % (Math.PI*2)));
                        if(diff < 0.8) { this.enemies.splice(i,1); Launcher.score++; }
                        else if(dist < 20) Launcher.over("Protection bris√©e !");
                    }
                });
                if(Launcher.score >= 15) Launcher.win("Rien ne peut nous atteindre.");
            }
            draw() {
                ctx.strokeStyle = "#00d2ff"; ctx.lineWidth = 6; ctx.beginPath();
                ctx.arc(160, 200, 50, this.ang, this.ang+1.2); ctx.stroke();
                this.enemies.forEach(en => { ctx.fillStyle="#ff4757"; ctx.beginPath(); ctx.arc(en.x, en.y, 5, 0, 7); ctx.fill(); });
                drawPrincess(145, 185, 30);
            }
        }

        // --- 4. FLY ---
        class FlyGame {
            constructor() { this.py = 200; this.v = 0; this.pipes = []; this.f = 0; }
            update() {
                this.v += 0.25; this.py += this.v;
                if(Input.left || Input.right) { this.v = -4.5; Input.left = Input.right = false; }
                if(this.f++ % 80 === 0) this.pipes.push({x: 320, h: Math.random()*150+50});
                this.pipes.forEach((p, i) => {
                    p.x -= 3;
                    if(p.x < 80 && p.x > 30 && (this.py < p.h || this.py > p.h + 90)) Launcher.over("Oups, l'obstacle !");
                    if(p.x === 20) Launcher.score++;
                });
                if(this.py > 400 || this.py < 0) Launcher.over("Reviens sur terre !");
                if(Launcher.score >= 10) Launcher.win("On survole tous les probl√®mes !");
            }
            draw() {
                ctx.fillStyle = "#555";
                this.pipes.forEach(p => { ctx.fillRect(p.x, 0, 40, p.h); ctx.fillRect(p.x, p.h+100, 40, 400); });
                drawPrincess(50, this.py, 25);
            }
        }

        // --- 5. KISS (TIMING) ---
        class KissGame {
            constructor() { this.a = 0; this.target = Math.random()*Math.PI*2; }
            update() {
                this.a += 0.05 + (Launcher.score*0.01);
                if(Input.left || Input.right) {
                    Input.left = Input.right = false;
                    let diff = Math.abs((this.a % (Math.PI*2)) - this.target);
                    if(diff < 0.4) { Launcher.score++; this.target = Math.random()*Math.PI*2; }
                    else Launcher.over("Manqu√© !");
                }
                if(Launcher.score >= 10) Launcher.win("Ton timing est parfait !");
            }
            draw() {
                ctx.strokeStyle = "#333"; ctx.lineWidth = 15; ctx.beginPath(); ctx.arc(160, 200, 80, 0, 7); ctx.stroke();
                ctx.strokeStyle = varProp('--gold'); ctx.beginPath(); ctx.arc(160, 200, 80, this.target-0.3, this.target+0.3); ctx.stroke();
                let kx = 160 + Math.cos(this.a)*80, ky = 200 + Math.sin(this.a)*80;
                ctx.font = "20px Arial"; ctx.fillText("üíã", kx-10, ky+10);
                drawPrincess(145, 185, 30);
            }
        }

        // --- 6. UP (ASCENT) ---
        class UpGame {
            constructor() {
                this.p = {x: 160, y: 300, v: 0};
                this.plats = [];
                for(let i=0; i<6; i++) this.plats.push({x: Math.random()*250, y: i*70, w: 60});
            }
            update() {
                this.p.v += 0.2; this.p.y += this.p.v;
                if(Input.left) this.p.x -= 4; if(Input.right) this.p.x += 4;
                this.plats.forEach(pl => {
                    if(this.p.v > 0 && this.p.x+20 > pl.x && this.p.x < pl.x+pl.w && this.p.y+30 > pl.y && this.p.y+30 < pl.y+15) {
                        this.p.v = -7; Launcher.score++;
                    }
                    pl.y += 1.5; if(pl.y > 400) { pl.y = 0; pl.x = Math.random()*250; }
                });
                if(this.p.y > 400) Launcher.over("Rattrap√©e ! Recommence.");
                if(Launcher.score >= 50) Launcher.win("On atteint les sommets !");
            }
            draw() {
                ctx.fillStyle = "#2ecc71";
                this.plats.forEach(pl => ctx.fillRect(pl.x, pl.y, pl.w, 8));
                drawPrincess(this.p.x, this.p.y, 30);
            }
        }

        function varProp(name) { return getComputedStyle(document.documentElement).getPropertyValue(name); }
    </script>
</body>
</html>
